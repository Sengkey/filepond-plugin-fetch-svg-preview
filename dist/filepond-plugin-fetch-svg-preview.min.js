/*!
 * FilePondPluginFetchSVGPreview 1.0.5
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit undefined for details.
 */

/* eslint-disable */

!function(e,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(e="undefined"!=typeof globalThis?globalThis:e||self).FilePondPluginFetchSVGPreview=i()}(this,(function(){"use strict";const e=e=>/^.+\.svg/.test(e.name)&&!/^image/.test(e.type),i=i=>i.utils.createView({name:"fetch-svg-preview-wrapper",create:({root:t,props:d})=>{const r=(i=>i.utils.createView({name:"fetch-svg-preview",tag:"div",ignoreRect:!0,create:({root:e,props:i})=>{const{id:t}=i;e.query("GET_ITEM",{id:i.id}),e.ref.media=document.createElement("div"),e.element.appendChild(e.ref.media)},write:i.utils.createRoute({DID_MEDIA_PREVIEW_LOAD:({root:i,props:t})=>{const{id:d}=t,r=i.query("GET_ITEM",{id:t.id});if(!r)return;let o=window.URL||window.webkitURL,n=new Blob([r.file],{type:r.file.type});i.ref.media.type=r.file.type,i.ref.media.src=r.file.mock&&r.file.url||o.createObjectURL(n),e(r.file)&&fetch(i.ref.media.src).then((e=>e.text())).then((e=>{i.ref.media.insertAdjacentHTML("afterbegin",e);const d=(/viewBox="([^"]+)"/.exec(e)||"")[1].split(" "),r=+d[2],o=+d[3]/(r/i.ref.media.offsetWidth);i.dispatch("DID_UPDATE_PANEL_HEIGHT",{id:t.id,height:o})}))}})}))(i);t.ref.media=t.appendChildView(t.createChildView(r,{id:d.id}))},write:i.utils.createRoute({DID_MEDIA_PREVIEW_CONTAINER_CREATE:({root:e,props:i})=>{const{id:t}=i;e.query("GET_ITEM",t)&&e.dispatch("DID_MEDIA_PREVIEW_LOAD",{id:t})}})}),t=t=>{const{addFilter:d,utils:r}=t,{Type:o,createRoute:n}=r,c=i(t);return d("CREATE_VIEW",(i=>{const{is:t,view:d,query:r}=i;if(!t("file"))return;d.registerWriter(n({DID_LOAD_ITEM:({root:i,props:t})=>{const{id:o}=t,n=r("GET_ITEM",o);n&&!n.archived&&e(n.file)&&(i.ref.mediaPreview=d.appendChildView(d.createChildView(c,{id:o})),i.dispatch("DID_MEDIA_PREVIEW_CONTAINER_CREATE",{id:o}))}},(({root:i,props:t})=>{const{id:d}=t,o=r("GET_ITEM",d);e(o.file)&&i.rect.element.hidden})))})),{options:{allowFetchSVGPreview:[!0,o.BOOLEAN]}}};return"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:t})),t}));
