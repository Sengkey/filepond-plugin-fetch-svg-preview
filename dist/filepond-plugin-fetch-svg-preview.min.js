/*!
 * FilePondPluginFetchSVGPreview 1.0.9
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit undefined for details.
 */

/* eslint-disable */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).FilePondPluginFetchSVGPreview=t()}(this,(function(){"use strict";const e=e=>/^.+\.svg/.test(e.name)&&!/^image/.test(e.type);const t=t=>t.utils.createView({name:"fetch-svg-preview-wrapper",create:({root:i,props:r})=>{const d=(t=>t.utils.createView({name:"fetch-svg-preview",tag:"div",ignoreRect:!0,create:({root:e,props:t})=>{const{id:i}=t;e.query("GET_ITEM",{id:t.id}),e.ref.media=document.createElement("div"),e.element.appendChild(e.ref.media)},write:t.utils.createRoute({DID_MEDIA_PREVIEW_LOAD:({root:t,props:i})=>{const{id:r}=i,d=t.query("GET_ITEM",{id:i.id});if(!d)return;let o=window.URL||window.webkitURL,n=new Blob([d.file],{type:d.file.type});t.ref.media.type=d.file.type,t.ref.media.src=d.file.mock&&d.file.url||o.createObjectURL(n),e(d.file)&&fetch(t.ref.media.src).then((e=>e.text())).then((e=>{t.ref.media.insertAdjacentHTML("afterbegin",function(e){var t=e;const i=e.match(/<\s*a[^>]*>(.*?)/g);return i&&i.length>0&&i.map((e=>{t=t.replace(e,"").replace("</a>","")})),t}(e));const r=(/viewBox="([^"]+)"/.exec(e)||"")[1].split(" "),d=+r[2],o=+r[3]/(d/t.ref.media.offsetWidth);t.dispatch("DID_UPDATE_PANEL_HEIGHT",{id:i.id,height:o})}))}})}))(t);i.ref.media=i.appendChildView(i.createChildView(d,{id:r.id}))},write:t.utils.createRoute({DID_MEDIA_PREVIEW_CONTAINER_CREATE:({root:e,props:t})=>{const{id:i}=t;e.query("GET_ITEM",i)&&e.dispatch("DID_MEDIA_PREVIEW_LOAD",{id:i})}})}),i=i=>{const{addFilter:r,utils:d}=i,{Type:o,createRoute:n}=d,c=t(i);return r("CREATE_VIEW",(t=>{const{is:i,view:r,query:d}=t;if(!i("file"))return;r.registerWriter(n({DID_LOAD_ITEM:({root:t,props:i})=>{const{id:o}=i,n=d("GET_ITEM",o);n&&!n.archived&&e(n.file)&&(t.ref.mediaPreview=r.appendChildView(r.createChildView(c,{id:o})),t.dispatch("DID_MEDIA_PREVIEW_CONTAINER_CREATE",{id:o}))}},(({root:t,props:i})=>{const{id:r}=i,o=d("GET_ITEM",r);o&&e(o.file)&&t.rect.element.hidden})))})),{options:{allowFetchSVGPreview:[!0,o.BOOLEAN]}}};return"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:i})),i}));
